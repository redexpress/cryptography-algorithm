# cryptography-algorithm

## 比特币地址

比特币有私钥和比特币地址，比特币地址用来收款，私钥用来提币。

比特币私钥通过椭圆曲线算法生成公钥，再转化为比特币地址。

### 比特币公钥转化为地址的算法

比特币公钥最初的形式是一个坐标值(x,y)，x和y都是很大的整数。

我们使用《精通比特币》上的一个公钥

x=41637322786646325214887832269588396900663353932545912953362782457239403430124，

y=16388935128781238405526710466724741593761085120864331449066658622400339362166

说明如何转化为比特币地址：

1. 使用二进制把x表示成byte数组
2. 如果x是偶数，在1的结果前面添加一字节0x02，如果x是奇数，在1前面添加一个字节0x03
3. 对2的结果进行sha256计算
4. 对3的结果进行Ripemd160计算，并在前面添加一个字节0x00
5. 对4的结果进行两次sha256计算，并取前面的4个字节。
6. 4的结果和5的结果合并起来，再进行base58编码

伪代码如下：

```
calc_bitcoin_address(x):
    if is_odd(x):
    		prefix1 = 0x03
    else
        prefix1 = 0x02
    digest = ripemd160(sha256(prefix1 | to_bytes(x) )
    digest_with_prefix = (0x00 | digest)
    checksum = sha256(sha256(digest_with_prefix))
    address = base58(digest_with_prefix | checksum )
```

> 说明：| 表示左右两部分进行连接。

由上面的算法可知，比特币地址一定是1开头，长度最长为34个字符。

## 常用密码学算法

### Base62x

Base62x可以认为是Base64的变体，有以下区别：

- Base62x不使用填充字符
- Base62x不使用`+`，`/`符号，使用`x1`，`x2`，`x3`

Base64和Base62x比较表

|            | Base64 | Base62x | 说明            |
| ---------- | ------ | ------- | --------------- |
| 0          | A      | 0       |                 |
| 1          | B      | 1       |                 |
| ...        | ...    | ...     |                 |
| 9          | J      | 9       |                 |
| 10         | K      | A       |                 |
| ...        | ...    | ...     |                 |
| 25         | Z      | P       |                 |
| 26         | a      | Q       |                 |
| ...        | ...    | ...     |                 |
| 33         | h      | X       |                 |
| 34         | i      | Y       |                 |
| 35         | j      | Z       |                 |
| 36         | k      | a       |                 |
| ...        | ...    | ...     |                 |
| 51         | z      | p       |                 |
| 52         | 0      | q       |                 |
| ...        | ...    | ...     |                 |
| 58         | 6      | w       | w之后是z        |
| 59         | 7      | y       |                 |
| 60         | 8      | z       |                 |
| 61         | 9      | x1      | 使用二个字符    |
| 62         | +      | x2      | 使用二个字符    |
| 63         | /      | x3      | 使用二个字符    |
| (填充字符) | =      |         | Base62x不使填充 |

### Base58

Base58使用英文和数字中的58个字符"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"进行编码，不使用容易混淆的字符，大写的i，小写的L，数字0和，大写的o。

Base在对byte数组进行编码时，如果前面的内容为\0的字节，用0进行编码，每个字节用一个0表示。

| 余数 | Base58 |         |
| ---- | ------ | ------- |
| 0    | 1      | 不使用0 |
| 1    | 2      |         |
| ...  | ...    |         |
| 8    | 9      |         |
| 9    | A      |         |
| ...  | ...    |         |
| 16   | H      |         |
| 17   | J      | 不使用I |
| ...  | ...    |         |
| 21   | N      |         |
| 22   | P      | 不使用O |
| ...  | ...    |         |
| 32   | Z      |         |
| 33   | a      |         |
| ...  | ...    |         |
| 43   | k      |         |
| 44   | m      | 不使用l |
| ...  | ...    |         |
| 57   | z      |         |

